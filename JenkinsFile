node {
def app
 environment {
    DOCKERHUB_CREDENTIALS = credentials('dockerhub')
  }
  stage('SCM') {
    checkout scm
  }
  
  stage('SonarQube Analysis') {
    def scannerHome = tool 'sonarqube_scanner';
    withSonarQubeEnv() {
      sh "${scannerHome}/bin/sonar-scanner"
    }
    
  }
  
  
    stage('Build') {
      steps {
        sh 'docker build -t lloydmatereke/jenkins-docker-hub .'
     
        sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
    
        sh 'docker push lloydmatereke/jenkins-docker-hub'
      }
    }
  stage('Unit Test')
  {
  
  }
  
  stage('Integration Test')
  {
  
  }
  
  stage('Deployment')
  {
  
  }
  }
  post {
    always {
      sh 'docker logout'
    }
  }
  }

  
  
  

